<!-- Filtro per categorie -->
<form id="categoryForm" action="" method="GET">
  <div class="dropdown">
    <!-- Bottone che mostra la categoria selezionata -->
    <button
      id="categoryButton"
      class="btn dropdown-toggle"
      type="button"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      Categoria
    </button>

    <ul class="dropdown-menu">
      <li>
        <button
          name="category"
          value="Motori"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Motori')"
        >
          Motori
        </button>
      </li>
      <li>
        <button
          name="category"
          value="Immobili"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Immobili')"
        >
          Immobili
        </button>
      </li>
      <li>
        <button
          name="category"
          value="Servizi"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Servizi')"
        >
          Servizi
        </button>
      </li>
      <li>
        <button
          name="category"
          value="Elettronica"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Elettronica')"
        >
          Elettronica
        </button>
      </li>
      <li>
        <button
          name="category"
          value="Per la casa e la persona"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Per la casa e la persona')"
        >
          Per la casa e la persona
        </button>
      </li>
      <li>
        <button
          name="category"
          value="Sport e Hobby"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Sport e Hobby')"
        >
          Sport e Hobby
        </button>
      </li>
      <li>
        <button
          name="category"
          value="Altro"
          class="dropdown-item"
          type="button"
          onclick="updateCategory('Altro')"
        >
          Altro
        </button>
      </li>
    </ul>
  </div>
</form>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const actionUrl = window.location.pathname;
    const form = document.getElementById("categoryForm");
    form.action = actionUrl;

    const urlParams = new URLSearchParams(window.location.search);
    const selectedCategory = urlParams.get("category");

    if (selectedCategory) {
      // Aggiorna il testo del bottone dropdown con la categoria selezionata
      const categoryButton = document.getElementById("categoryButton");
      const selectedOption = document.querySelector(
        `button[name="category"][value="${selectedCategory}"]`
      );
      if (selectedOption) {
        categoryButton.textContent = selectedOption.textContent;
      }
    }
  });

  // Funzione per aggiornare la categoria e reindirizzare la pagina
  function updateCategory(category) {
    const categoryButton = document.getElementById("categoryButton");
    const selectedOption = document.querySelector(
      `button[name="category"][value="${category}"]`
    );
    if (selectedOption) {
      categoryButton.textContent = selectedOption.textContent;
    }

    // Aggiorna il parametro "category" nella URL e ricarica la pagina
    const url = new URL(window.location);
    url.searchParams.set("category", category);
    window.location.href = url.href;
  }
</script>
